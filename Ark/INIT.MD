## INIT.MD

# Prompt maestro para Cursor ‚Äî Sistema de Gesti√≥n de Citas, Check-in y Control de Cola (Instituto Oncol√≥gico)

> Este documento contiene un **prompt listo para pegar en Cursor** (modo generaci√≥n de proyecto o como archivo `.prompt`) que le indica a Cursor c√≥mo generar **todo** el prototipo funcional: backend + frontend + migraciones + seeds + docker-compose + instrucciones paso a paso.

---
---

# üè• **PROYECTO: Sistema de Gesti√≥n de Citas, Check-in y Control de Cola ‚Äî Instituto Oncol√≥gico**

### Objetivo

Construir un **prototipo funcional completo** que incluya todas las pantallas, flujos, rutas, componentes, datos de prueba y l√≥gica base del sistema.

Las pantallas y las funciones deben estar conectadas en un flujo real utilizando Vue Router, Pinia, APIs REST y SQLite mediante Sequelize.

## 1) Instrucci√≥n general (System / primer mensaje)

Eres un **arquitecto senior fullstack** experto en Node.js, TypeScript, Express, Vue 3, Tailwind y sistemas cl√≠nicos.  
Tu tarea es **generar autom√°ticamente toda la estructura del proyecto**, incluyendo backend, frontend y un prototipo navegable completo, basado exactamente en las definiciones iniciales dadas.

Genera c√≥digo real, limpio, ordenado, modular y funcional.

Eres un **arquitecto fullstack senior** y generador de proyectos listo para producir c√≥digo de alta calidad. Genera **un proyecto completo** con backend y frontend, listo para ejecutar localmente y contener:

- C√≥digo fuente del backend (Express + TypeScript + Sequelize + SQLite).    
- C√≥digo fuente del frontend (Vue 3 + TypeScript + Vite + Tailwind + Pinia + Vue Router).    
- Migraciones y seeders para poblar datos de prueba.    
- Scripts `npm` para iniciar backend y frontend en modo desarrollo.    
- Dockerfile para backend y frontend y `docker-compose.yml` para levantar la app completa.    
- README con instrucciones claras de instalaci√≥n y ejecuci√≥n.    

Debes generar archivos completos, con contenido funcional, comentarios explicativos y estructura modular. El proyecto debe ser instalable con:

```
# backend
cd backend
npm install
npm run migrate
npm run seed
npm run dev

# frontend
cd frontend
npm install
npm run dev
```

Genera tests b√°sicos (opcional) y aseg√∫rate que las rutas y stores funcionen con datos simulados.

---

## 2) Estructura general a crear

```
/project-root
  /backend
  /frontend
  docker-compose.yml
  README.md
```

---

## 3) Backend ‚Äî requisitos detallados

Genera un proyecto Node.js + TypeScript con la siguiente estructura m√≠nima y archivos funcionales:

```
/backend
  package.json
  tsconfig.json
  .env.example
  Dockerfile
  /src
    server.ts
    /config
      database.ts
      jwt.ts
    /models
      index.ts
      patient.model.ts
      staff.model.ts
      appointment.model.ts
      queue.model.ts
      chemoChair.model.ts
      recoveryRoom.model.ts
    /migrations
      (migrations for tables)
    /seeders
      (seed data)
    /controllers
      auth.controller.ts
      patient.controller.ts
      appointment.controller.ts
      queue.controller.ts
      tv.controller.ts
      ocr.controller.ts  # mock
    /routes
      auth.routes.ts
      patient.routes.ts
      appointment.routes.ts
      queue.routes.ts
      tv.routes.ts
    /services
      queue.service.ts
      ocr.service.ts # simulated OCR
    /middleware
      auth.middleware.ts
      logger.middleware.ts
      error.handler.ts
    /utils
      qr.util.ts
      helpers.ts
```

### Dependencias (package.json)

- express    
- typescript    
- ts-node-dev (dev)    
- sequelize    
- sqlite3    
- sequelize-typescript or @types/sequelize (type bindings)    
- multer    
- jsonwebtoken    
- helmet    
- morgan    
- axios    
- cors    
- dotenv    

Incluye tipos `@types/` cuando corresponda.

### Funcionalidades clave a implementar

- CRUD b√°sico para pacientes `/patients`.    
- CRUD y l√≥gica de citas `/appointments` (crear, listar, disponibilidad).    
- Endpoints de check-in `/appointments/:id/checkin` y de cambio de estado `/appointments/:id/state`.    
- Endpoints de turnero `/queue` para obtener la cola actual y para avanzar al siguiente paciente `/queue/next?service=...`.    
- Endpoint `/ocr/id` que reciba una imagen (Multer) y devuelva datos extra√≠dos simulados (mock) ‚Äî suficiente para el prototipo.    
- Servicio de colas en memoria con persistencia b√°sica en SQLite usando Sequelize.    
- Seeders que creen: 30 pacientes, 50 citas (varias en el d√≠a), 9 sillas de quimio (estado), 2 habitaciones de recuperaci√≥n.    
- Logger con Morgan y seguridad con Helmet.    
- Middleware de manejo de errores y validaciones simples.    
- Lectura de imagen del documento de identidad con IA para extraer los datos del paciente.

Aseg√∫rate que las rutas devuelvan JSON coherente con datos reales y simulados.

---

## 4) Frontend ‚Äî requisitos detallados

Genera un proyecto Vite + Vue 3 + TypeScript con la siguiente estructura:

```
/frontend
  package.json
  tsconfig.json
  vite.config.ts
  tailwind.config.js
  postcss.config.js
  Dockerfile
  /src
    main.ts
    App.vue
    /assets
    /router
      index.ts
    /stores
      auth.ts
      appointments.ts
      queue.ts
      chemo.ts
    /views
      PatientPortal.vue
      BookAppointment.vue
      CalendarView.vue
      MyAppointments.vue
      CounterLogin.vue
      ReceptionSearch.vue
      Checkin.vue
      TVDisplay.vue
      Consultorio.vue
      Laboratorio.vue
      Quimioterapia.vue
      Recuperacion.vue
      AdminDashboard.vue
    /components
      Header.vue
      Footer.vue
      AppointmentForm.vue
      CalendarComponent.vue
      QRCard.vue
      QueueList.vue
      ChemoMap.vue
      PatientCard.vue
      LoginForm.vue
    /services
      api.ts  # axios instance
      auth.service.ts
      appointment.service.ts
      queue.service.ts
    /utils
      format.ts
      mocks.ts
    /styles
      globals.css (Tailwind)
```

### UI & UX

- Usa Tailwind para implementar la paleta: `#2BB88A`, `#F4F6F8`, blanco y naranja `#F5A623`/rojo suave.    
- Tipograf√≠a `font-sans` (Tailwind). Asegura accesibilidad: tama√±os, contrastes y botones grandes.    
- Todas las vistas deben estar enlazadas con Vue Router y tener rutas protegidas para √°reas de staff (Counter, Consultorios, Admin).    

### Funcionalidad m√≠nima por vista

- **Book Appointment**: Formulario con selector de servicio + CalendarView para elegir fecha/hora; env√≠a POST a `/appointments`.    
- **CalendarView**: muestra disponibilidad y slots (usando datos del endpoint de disponibilidad).    
- **MyAppointments**: lista de citas del paciente con estados y posibilidad de cancelar.    
- **CounterLogin / ReceptionSearch / Checkin**: buscar paciente, ver citas, realizar check-in y cambiar estado.    
- **TVDisplay**: pantalla p√∫blica que hace polling a `/queue` cada 5-10s y renderiza lista tipo turnero con animaci√≥n simple cuando cambia el `current`.    
- **Consultorio / Laboratorio / Quimioterapia / Recuperacion**: vistas con acciones para llamar siguiente paciente, cambiar estados y ver mapa de sillas (drag & drop para Quimio; usar `vuedraggable` or simple drag-drop mock).    
- **AdminDashboard**: gr√°ficos simples (usar Chart.js) que consumen endpoints de stats (ej: `/admin/stats`).   
A√±ade notificaciones con `Vue Toastification` y manejo de errores. Usa Pinia para stores y organiza la l√≥gica (auth, appointments, queue, chemo).
Genera datos mock integrados y tambi√©n instrucciones para conectar con el backend real si el usuario corre ambos servicios.

---

## 5) Migrations / Seeders

Genera scripts de migraci√≥n usando Sequelize CLI (o script TypeScript equivalente) que creen tablas necesarias.
Seeders deben poblar la base con datos realistas: pacientes con nombres, edades, citas en distintos estados, ocupaci√≥n de sillas de quimio y recuperaci√≥n.
Incluye comando `npm run migrate` y `npm run seed` en package.json del backend.

---

## 6) Despliegue
- service: backend (puerto 4000)    
- service: frontend (puerto 5173)        

---

## 7) Scripts `package.json` importantes

**Backend**

- `dev`: `ts-node-dev src/server.ts`    
- `build`: `tsc`    
- `migrate`: script que corre migraciones    
- `seed`: script que corre seeders    
- `start`: `node dist/server.js`    

**Frontend**

- `dev`: `vite`    
- `build`: `vite build`    
- `preview`: `vite preview`    

---

Generate full project: backend + frontend + docker-compose + migrations + seeders + README"
   
**C) Generate with automatic migrations**

- Add `npm run migrate` script that uses Sequelize programmatic migrations.    

**D) Generate Docker-compose**

- As described in section 6. Include env examples and notes for production.    

---

## 9) README.md (contenido a generar)

README must include:

- Overview    
- Tech stack    
- Prerequisites    
- Environment variables list (.env.example)    
- How to run migrations and seeders    
- How to access frontend ([http://localhost:5173](http://localhost:5173/)) and backend ([http://localhost:4000](http://localhost:4000/))    
- Useful endpoints    

---

## 10) Entregables finales y verificaci√≥n

Al terminar la generaci√≥n, Cursor debe entregar:

1. Mensaje con checklist "Files created" con los paths y comandos para correr.        
2. `README.md` completo.    
3. Indicaci√≥n clara para correr migraciones y seeds.    
4. Opcional: archivo `.cursor-commands.txt` con instrucciones de comandos para ejecutar en terminal.    

---

## 11) Solicitud final para Cursor (texto exacto de ejecuci√≥n)

> "Genera el proyecto completo siguiendo las instrucciones de este documento.> 
> - Modo: **Full generate** (si puedes elegir: full).>     
> - Incluye: backend (Express + TS + Sequelize + SQLite + Multer + JWT + Helmet + Morgan), frontend (Vue3 + TS + Vite + Tailwind + Pinia + Vue Router + Toastification), migraciones, seeders, README, y scripts `npm run migrate` y `npm run seed`.>     
> - Genera tambi√©n una variante step-by-step (dividida en 6 pasos) con checklist.>     
> - Aseg√∫rate que `npm install` + `npm run dev` (backend y frontend) funcione.>     
> - Provee instrucciones exactas para ejecutar en local"
>     

---

## 12) Notas de seguridad y privacidad

- Por seguridad habilita Helmet y CORS correctamente.    
- Los JWT deben usar secret en `.env`.    

---

## 13) Ejemplo m√≠nimo de `.env.example` (backend)

```
PORT=4000
DATABASE_URL=sqlite://./database.sqlite
JWT_SECRET=change_this_secret
NODE_ENV=development
```

## 14) Ejemplo m√≠nimo de `.env.example` (frontend)

```
VITE_API_URL=http://localhost:4000/api
```

